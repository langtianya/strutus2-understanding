
<!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE- 2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <LINK type="text/css" rel="stylesheet" href="https://struts.apache.org/css/default.css">
    <STYLE type="text/css">
      .dp-highlighter {
        width:95% !important;
      }
    </STYLE>
    <STYLE type="text/css">
      .footer {
        background-image:      url('https://cwiki.apache.org/confluence/images/border/border_bottom.gif');
        background-repeat:     repeat-x;
        background-position:   left top;
        padding-top:           4px;
        color:                 #666;
      }
    </STYLE>
    <SCRIPT type="text/javascript" language="javascript">
      var hide = null;
      var show = null;
      var children = null;

      function init() {
        /* Search form initialization */
        var form = document.forms['search'];
        if (form != null) {
          form.elements['domains'].value = location.hostname;
          form.elements['sitesearch'].value = location.hostname;
        }

        /* Children initialization */
        hide = document.getElementById('hide');
        show = document.getElementById('show');
        children = document.all != null ?
                   document.all['children'] :
                   document.getElementById('children');
        if (children != null) {
          children.style.display = 'none';
          show.style.display = 'inline';
          hide.style.display = 'none';
        }
      }

      function showChildren() {
        children.style.display = 'block';
        show.style.display = 'none';
        hide.style.display = 'inline';
      }

      function hideChildren() {
        children.style.display = 'none';
        show.style.display = 'inline';
        hide.style.display = 'none';
      }
    </SCRIPT>
    <TITLE>Form Validation</TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">
    <TABLE border="0" cellpadding="2" cellspacing="0" width="100%">
      <TR class="topBar">
        <TD align="left" valign="middle" class="topBarDiv" align="left" nowrap="">
          &nbsp;<A href="home.html" title="Apache Struts 2 Documentation">Apache Struts 2 Documentation</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="tutorials.html" title="Tutorials">Tutorials</A>&nbsp;&gt;&nbsp;<A href="getting-started.html" title="Getting Started">Getting Started</A>&nbsp;&gt;&nbsp;<A href="how-to-create-a-struts-2-web-application.html" title="How To Create A Struts 2 Web Application">How To Create A Struts 2 Web Application</A>&nbsp;&gt;&nbsp;<A href="create-struts-2-web-application-with-artifacts-in-web-inf-lib-and-use-ant-to-build-the-application.html" title="Create Struts 2 Web Application With Artifacts In WEB-INF lib and Use Ant To Build The Application">Create Struts 2 Web Application With Artifacts In WEB-INF lib and Use Ant To Build The Application</A>&nbsp;&gt;&nbsp;<A href="hello-world-using-struts-2.html" title="Hello World Using Struts 2">Hello World Using Struts 2</A>&nbsp;&gt;&nbsp;<A href="using-struts-2-tags.html" title="Using Struts 2 Tags">Using Struts 2 Tags</A>&nbsp;&gt;&nbsp;<A href="coding-struts-2-actions.html" title="Coding Struts 2 Actions">Coding Struts 2 Actions</A>&nbsp;&gt;&nbsp;<A href="processing-forms.html" title="Processing Forms">Processing Forms</A>&nbsp;&gt;&nbsp;<A href="" title="Form Validation">Form Validation</A>
        </TD>
        <TD align="right" valign="middle" nowrap="">
          <FORM name="search" action="http://www.google.com/search" method="get">
            <INPUT type="hidden" name="ie" value="UTF-8">
            <INPUT type="hidden" name="oe" value="UTF-8">
            <INPUT type="hidden" name="domains" value="">
            <INPUT type="hidden" name="sitesearch" value="">
            <INPUT type="text" name="q" maxlength="255" value="">        
            <INPUT type="submit" name="btnG" value="Google Search">
          </FORM>
        </TD>
      </TR> 
    </TABLE>

    <DIV id="PageContent">
      <DIV class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="/wiki/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <DIV style="margin: 0px 10px 0px 10px" class="smalltext">Apache Struts 2 Documentation</DIV>
        <DIV style="margin: 0px 10px 8px 10px" class="pagetitle">Form Validation</DIV>

        <DIV class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
          <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=14811892">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/notep_16.gif" height="16" width="16" border="0" align="absmiddle" title="Edit Page"></A>
            <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=14811892">Edit Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=WW">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/browse_space.gif" height="16" width="16" border="0" align="absmiddle" title="Browse Space"></A>
            <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=WW">Browse Space</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=WW&fromPageId=14811892">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_page_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add Page"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=WW&fromPageId=14811892">Add Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=WW&fromPageId=14811892">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add News"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=WW&fromPageId=14811892">Add News</A>
        </DIV>
      </DIV>

      <DIV class="pagecontent">
        <DIV class="wiki-content">
          <DIV class="panelMacro"><TABLE class="infoMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>This tutorial assumes you've completed the <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> tutorial and have a working Form_Processing_Struts2_Ant (or Form_Processing_Struts2_Mvn) project.  The example code for this tutorial, Form_Validation_Struts2_Ant or Form_Validation_Struts2_Mvn, is available on Google Code - <A href="http://code.google.com/p/struts2-examples/downloads/list" class="external-link" rel="nofollow">http://code.google.com/p/struts2-examples/downloads/list</A>.  After downloading and unzipping the file, you'll have a folder named Form_Validation_Struts2_Ant (or Form_Validation_Struts2_Mvn).  In that folder will be a README.txt file with instructions on now to build and run the example application.</TD></TR></TABLE></DIV>

<H3><A name="FormValidation-Introduction"></A>Introduction</H3>
<P>In this tutorial we'll explore using Struts 2 to validate the user's input on a form.  There are two ways you can use Struts 2 to do form validation.  This tutorial will cover the more basic method, where the validation is included in the Struts 2 Action class.  </P>

<P>The code provided in this tutorial may be added to the <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> example or you can download this complete example from Google Code - <A href="http://code.google.com/p/struts2-examples/downloads/list" class="external-link" rel="nofollow">http://code.google.com/p/struts2-examples/downloads/list</A>.</P>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>The <A href="http://struts.apache.org/mail.html" class="external-link" rel="nofollow">Struts 2 user mailing list</A> is an excellent place to get help.  If you are having a problem getting the tutorial example applications to work search the Struts 2 mailing list.  If you don't find an answer to your problem, post a question on the mailing list.</TD></TR></TABLE></DIV>

<H3><A name="FormValidation-AddvalidateMethod"></A>Add validate Method</H3>
<P>To enable the Struts 2 Action class to validate a user's input on a Struts 2 form, you must define a validate method in your Action class.  Using the example from <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> tutorial, let's say that we have these business rules:</P>

<P>1. User must provide a first name<BR>
2. User must provide an email address<BR>
3. User younger then 18 cannot register</P>

<P>If you recall from the <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> tutorial the user's input into the form fields is placed by Struts 2 into the Java model class personBean.  So a user's input into the firstName field would end up as the value for personBean's firstName instance field (via the personBean.setFirstName method).</P>

<P>In the validate method we can refer to get the values of personBean's instance fields by using the appropriate get methods.  Once we have the values we can employ logic to enforce our business rules.</P>

<P>Add the following validate method to Register.java (the Action class).</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>validate method</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
	<SPAN class="code-keyword">public</SPAN> void validate(){
		
		<SPAN class="code-keyword">if</SPAN> ( personBean.getFirstName().length() == 0 ){	

			addFieldError( <SPAN class="code-quote">&quot;personBean.firstName&quot;</SPAN>, <SPAN class="code-quote">&quot;First name is required.&quot;</SPAN> );
			
		}
		
				
		<SPAN class="code-keyword">if</SPAN> ( personBean.getEmail().length() == 0 ){	

			addFieldError( <SPAN class="code-quote">&quot;personBean.email&quot;</SPAN>, <SPAN class="code-quote">&quot;Email is required.&quot;</SPAN> );
			
		}
		
		<SPAN class="code-keyword">if</SPAN> ( personBean.getAge() &lt; 18 ){	

			addFieldError( <SPAN class="code-quote">&quot;personBean.age&quot;</SPAN>, <SPAN class="code-quote">&quot;Age is required and must be 18 or older&quot;</SPAN> );
			
		}
		
		
	}
</PRE>
</DIV></DIV>

<P>When the user presses the submit button on the register form, Struts 2 will transfer the user's input to the personBean's instance fields.  Then Struts 2 will automatically execute the validate method.  If any of the if statements are true, Struts 2 will call its addFieldError method (which our Action class inherited by extending ActionSupport).</P>

<P>If any errors have been added then Struts 2 will not proceed to call the execute method.  Rather the Struts 2 framework will return &quot;input&quot; as the result of calling the action.</P>

<H3><A name="FormValidation-HandleInputBeingReturned"></A>Handle Input Being Returned</H3>
<P>So what should we do if Struts 2 returns &quot;input&quot; indicating that the user's input in the form is not valid?  In most cases we will want to redisplay the web page that has the form and include in the form error messages to inform the user what is wrong.</P>

<P>To handle the return value of &quot;input&quot; we need to add the following result to our action node in struts.xml.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;result name=<SPAN class="code-quote">&quot;input&quot;</SPAN>&gt;</SPAN>/register.jsp<SPAN class="code-tag">&lt;/result&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>The above result node goes just after the success result node for the register action and before the closing of the action node.</P>

<H3><A name="FormValidation-ErrorMessages"></A>Error Messages</H3>
<P>So when validation fails and Struts 2 returns input, the Struts 2 framework will redisplay the register.jsp.  Since we used Struts 2 form tags, automatically Struts 2 will add the error messages.  These error messages are the ones we specified in the addFieldError method call.  The addFieldError method takes two arguments.  The first is the form field name to which the error applies and the second is the error message to display above that form field.</P>

<P>So the following addFieldError method call:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
addFieldError( <SPAN class="code-quote">&quot;personBean.firstName&quot;</SPAN>, <SPAN class="code-quote">&quot;First name is required.&quot;</SPAN>)
</PRE>
</DIV></DIV>
<P>will cause the message &quot;First name is required&quot; to be displayed above the firstName field on the form.</P>

<P>If you have made the above changes to the <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> tutorial or you have downloaded from <A href="http://code.google.com/p/struts2-examples/downloads/list" class="external-link" rel="nofollow">Google Code</A> either the Form_Validation_Struts2_Ant or Form_Validation_Struts2_Mvn projects run the application (see the README.txt in the project root folder).  Click on the Please register link.  On the registration form, just click the submit button and you should see:</P>

<P><SPAN class="image-wrap" style=""><IMG src="form-validation.data/form_errors.png" style="border: 0px solid black"></SPAN></P>

<P>Struts 2 called the validate method, validation failed, the register.jsp was displayed with the error messages.</P>

<H3><A name="FormValidation-StylingTheErrorMessages"></A>Styling The Error Messages</H3>
<P>The Struts 2 s:head tag can be used to provide CSS that includes a style for the error message.  Add <TT>&lt;s:head /&gt;</TT> to register.jsp before the closing HTML <TT>&lt;/head&gt;</TT> tag.  Go through the same steps as above and you should see:</P>

<P><SPAN class="image-wrap" style=""><IMG src="form-validation.data/form_errors_styled.png" style="border: 0px solid black"></SPAN></P>

<H3><A name="FormValidation-Summary"></A>Summary</H3>
<P>This tutorial covered validating a user's form input by adding a validate method to an Action class.  There is another more sophisticated way to validate user input using XML.  If you want to learn more about using XML for validation in Struts 2 see <A href="validation.html" title="Validation">Validation</A>.</P>

<H3><A name="FormValidation-UpNext"></A>Up Next</H3>

<P>In our next tutorial we'll cover how to use message resource files to separate out the text from the view page.</P>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Next </TH>
<TD class="confluenceTd"> Onward to <A href="message-resource-files.html" title="Message Resource Files">Message Resource Files</A> </TD>
</TR>
<TR>
<TH class="confluenceTh"> Prev </TH>
<TD class="confluenceTd"> Return to <A href="processing-forms.html" title="Processing Forms">Processing Forms</A> </TD>
</TR>
</TBODY></TABLE>
</DIV>

        </DIV>

                  <DIV class="tabletitle">
            Children
            <SPAN class="smalltext" id="show" style="display: inline;">
              <A href="javascript:showChildren()">Show Children</A></SPAN>
            <SPAN class="smalltext" id="hide" style="display: none;">
              <A href="javascript:hideChildren()">Hide Children</A></SPAN>
          </DIV>
          <DIV class="greybox" id="children" style="display: none;">
                                      <A href="message-resource-files.html" title="Message Resource Files">Message Resource Files</A>
              <SPAN class="smalltext">(Apache Struts 2 Documentation)</SPAN>
              <BR>
                      </DIV>
        
      </DIV>
    </DIV>
    <DIV class="footer">
      Generated by
      <A href="http://www.atlassian.com/confluence/">Atlassian Confluence</A> (Version: 3.4.9 Build: 2042 Feb 14, 2011)
      <A href="http://could.it/autoexport/">Auto Export Plugin</A> (Version: 1.0.0-dkulp)
    </DIV>
  </BODY>
</HTML>