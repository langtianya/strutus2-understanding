
<!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE- 2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <LINK type="text/css" rel="stylesheet" href="https://struts.apache.org/css/default.css">
    <STYLE type="text/css">
      .dp-highlighter {
        width:95% !important;
      }
    </STYLE>
    <STYLE type="text/css">
      .footer {
        background-image:      url('https://cwiki.apache.org/confluence/images/border/border_bottom.gif');
        background-repeat:     repeat-x;
        background-position:   left top;
        padding-top:           4px;
        color:                 #666;
      }
    </STYLE>
    <SCRIPT type="text/javascript" language="javascript">
      var hide = null;
      var show = null;
      var children = null;

      function init() {
        /* Search form initialization */
        var form = document.forms['search'];
        if (form != null) {
          form.elements['domains'].value = location.hostname;
          form.elements['sitesearch'].value = location.hostname;
        }

        /* Children initialization */
        hide = document.getElementById('hide');
        show = document.getElementById('show');
        children = document.all != null ?
                   document.all['children'] :
                   document.getElementById('children');
        if (children != null) {
          children.style.display = 'none';
          show.style.display = 'inline';
          hide.style.display = 'none';
        }
      }

      function showChildren() {
        children.style.display = 'block';
        show.style.display = 'none';
        hide.style.display = 'inline';
      }

      function hideChildren() {
        children.style.display = 'none';
        show.style.display = 'inline';
        hide.style.display = 'none';
      }
    </SCRIPT>
    <TITLE>Spring and Struts 2</TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">
    <TABLE border="0" cellpadding="2" cellspacing="0" width="100%">
      <TR class="topBar">
        <TD align="left" valign="middle" class="topBarDiv" align="left" nowrap="">
          &nbsp;<A href="home.html" title="Apache Struts 2 Documentation">Apache Struts 2 Documentation</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="tutorials.html" title="Tutorials">Tutorials</A>&nbsp;&gt;&nbsp;<A href="getting-started.html" title="Getting Started">Getting Started</A>&nbsp;&gt;&nbsp;<A href="" title="Spring and Struts 2">Spring and Struts 2</A>
        </TD>
        <TD align="right" valign="middle" nowrap="">
          <FORM name="search" action="http://www.google.com/search" method="get">
            <INPUT type="hidden" name="ie" value="UTF-8">
            <INPUT type="hidden" name="oe" value="UTF-8">
            <INPUT type="hidden" name="domains" value="">
            <INPUT type="hidden" name="sitesearch" value="">
            <INPUT type="text" name="q" maxlength="255" value="">        
            <INPUT type="submit" name="btnG" value="Google Search">
          </FORM>
        </TD>
      </TR> 
    </TABLE>

    <DIV id="PageContent">
      <DIV class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="/wiki/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <DIV style="margin: 0px 10px 0px 10px" class="smalltext">Apache Struts 2 Documentation</DIV>
        <DIV style="margin: 0px 10px 8px 10px" class="pagetitle">Spring and Struts 2</DIV>

        <DIV class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
          <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=23339629">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/notep_16.gif" height="16" width="16" border="0" align="absmiddle" title="Edit Page"></A>
            <A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=23339629">Edit Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=WW">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/browse_space.gif" height="16" width="16" border="0" align="absmiddle" title="Browse Space"></A>
            <A href="https://cwiki.apache.org/confluence/pages/listpages.action?key=WW">Browse Space</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=WW&fromPageId=23339629">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_page_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add Page"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=WW&fromPageId=23339629">Add Page</A>
          &nbsp;
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=WW&fromPageId=23339629">
            <IMG src="https://cwiki.apache.org/confluence/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" align="absmiddle" title="Add News"></A>
          <A href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=WW&fromPageId=23339629">Add News</A>
        </DIV>
      </DIV>

      <DIV class="pagecontent">
        <DIV class="wiki-content">
          <DIV class="panelMacro"><TABLE class="infoMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>The example code for this tutorial, Spring_Struts2_Ant or Spring_Struts2_Mvn, is available on Google Code - <A href="http://code.google.com/p/struts2-examples/downloads/list" class="external-link" rel="nofollow">http://code.google.com/p/struts2-examples/downloads/list</A>. After downloading and unzipping the file, you'll have a folder named Spring_Struts2_Ant (or Spring_Struts2_Mvn). In that folder will be a README.txt file with instructions on now to build and run the example application.</TD></TR></TABLE></DIV>

<H3><A name="SpringandStruts2-Introduction"></A>Introduction</H3>

<P>In the execute method of many Struts 2 ActionSupport classes are statements that create objects and then have those objects execute methods that perform needed tasks. Whenever one class creates an object of another class that introduces a dependency between the two classes. The Spring framework makes it easier for the application developer to manage these dependencies and helps make the application more flexible and maintainable. This tutorial will show you how to use Struts 2 and Spring together to manage the dependencies between your ActionSupport classes and other classes in your application.</P>

<DIV class="panelMacro"><TABLE class="infoMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>This tutorial assumes you understand how to use the Spring framework to manage dependencies between classes.  You can learn more about Spring by reading the documentation at <A href="http://www.springsource.org/documentation" class="external-link" rel="nofollow">http://www.springsource.org/documentation</A></TD></TR></TABLE></DIV>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>The <A href="http://struts.apache.org/mail.html" class="external-link" rel="nofollow">Struts 2 user mailing list</A> is an excellent place to get help. If you are having a problem getting the tutorial example applications to work search the Struts 2 mailing list. If you don't find an answer to your problem, post a question on the mailing list.</TD></TR></TABLE></DIV>

<P>If you examine the example application for the <A href="struts-2-themes.html" title="Struts 2 Themes">Struts 2 Themes</A> tutorial you'll see this code in the EditAction ActionSupport class</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>EditAction Class Hard-Coded Dependency</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">

<SPAN class="code-keyword">private</SPAN> EditService editService = <SPAN class="code-keyword">new</SPAN> EditServiceInMemory();

</PRE>
</DIV></DIV>

<P>The above statement hard-codes a dependency between the EditAction class and the EditServiceInMemory class.  This is poor design for two reasons.  </P>

<OL>
	<LI>If I need to replace the EditServiceInMemory with another class that implements the EditService interface I'll have to hunt down and replace all statements where I hard-coded the dependency.</LI>
	<LI>I cannot test EditAction without using the EditServiceInMemory class.  I cannot isolate EditAction by using a stub implementation of EditService when writing my test case because the use of EditServiceInMemory is hard-coded.</LI>
</OL>


<P>Spring provides a mechanism to manage dependencies by injecting them at run time. Struts 2 ActionSupport classes&mdash;like any other Java class&mdash;can be injected with a dependent object by the Spring framework.  So instead of having the above code, I would have this statement in EditAction.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>EditAction Class No Hard-Coded Dependency</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">

    <SPAN class="code-keyword">private</SPAN> EditService editService ;

</PRE>
</DIV></DIV>

<P>At run time the Spring framework will provide an object of a class that implements the EditService interface.</P>

<H3><A name="SpringandStruts2-Struts2SpringPlugin"></A>Struts 2 Spring Plugin</H3>

<P>Struts 2 provides a plugin that enables Spring to inject into the ActionSupport classes any dependent objects you've specified in the Spring configuration file.  Consult <A href="spring-plugin.html" title="Spring Plugin">Spring Plugin documentation</A> for more information about how the plugin works.  </P>

<P>For a Maven application you'll need to add a dependency to the struts2-spring-plugin jar (see the Maven example application for this tutorial).  The plugin's pom.xml includes transitive dependencies to the Spring jar files.  For an Ant built application you'll need to add the struts2-spring-plugin jar and the Spring jars to your application's class path (see the Ant example application for this tutorial).</P>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>The current version (2.3.1.2) of the Struts 2 Spring plugin has transitive dependencies to the Spring 3.0.5 version.  If you want to use the latest version of Spring, then you should exclude the transitive dependencies in your pom.xml for the Struts 2 Spring plugin and then declare dependency nodes to the current version of the Spring jar files.  If you are using Ant and explicitly including the jar files in your application, then just include the latest version of the Spring jar files.</TD></TR></TABLE></DIV>

<P>In your ActionSupport class you must have a set method for the dependent object that follows standard Java bean naming conventions.  If you examine the EditAction class for this tutorial's application you'll see this set method.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">

<SPAN class="code-keyword">public</SPAN> void setEditService(EditService editService) {
		
   <SPAN class="code-keyword">this</SPAN>.editService = editService;
		
}

</PRE>
</DIV></DIV>

<P>Spring will use that set method to provide an object of type EditService to the EditAction class at run time.</P>

<P>To make our application &quot;Spring aware&quot; we need to add this line to web.xml.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>Spring Listener In web.xml</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-xml">

<SPAN class="code-tag">&lt;listener&gt;</SPAN>
	<SPAN class="code-tag">&lt;listener-class&gt;</SPAN>org.springframework.web.context.ContextLoaderListener<SPAN class="code-tag">&lt;/listener-class&gt;</SPAN>
<SPAN class="code-tag">&lt;/listener&gt;</SPAN>

</PRE>
</DIV></DIV>

<P>The above code will activate the Spring framework when the application is started up by the Servlet container.  By default Spring will look for a configuration file name applicationContext.xml in WEB-INF (consult the Spring documentation for how you can change where Spring looks and what the configuration file name is).</P>

<H3><A name="SpringandStruts2-SpringConfigurationFile"></A>Spring Configuration File</H3>

<P>In the Spring configuration file we create a bean node for those objects we want Spring to create an instance of and inject into our ActionSupport class.  In the example application is this applicationContext.xml.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>Spring Configuration File</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-xml">

<SPAN class="code-tag">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;</SPAN>
&lt;beans xmlns=<SPAN class="code-quote">&quot;http://www.springframework.org/schema/beans&quot;</SPAN>
       <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
       xsi:schemaLocation=&quot;
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;

<SPAN class="code-tag">&lt;bean id=<SPAN class="code-quote">&quot;editService&quot;</SPAN> class=<SPAN class="code-quote">&quot;org.apache.struts.edit.service.EditServiceInMemory&quot;</SPAN> /&gt;</SPAN>

<SPAN class="code-tag">&lt;/beans&gt;</SPAN>

</PRE>
</DIV></DIV>

<P>Note the id value above.  By default the Spring plugin works with Spring to autowire the dependencies of the ActionClass by &quot;name.&quot;  Spring will create an object of class EditServiceMemory and provide that object to any ActionSupport class that has a setEditService method with an argument of type EditService.  Consult the  <A href="spring-plugin.html" title="Spring Plugin">Spring Plugin</A> documentation for how to change the default autowire method.</P>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>The editService bean created by Spring will have a scope of singleton since that is the default scope.  Consult section 3.5 of the <A href="http://www.springsource.org/documentation" class="external-link" rel="nofollow">Spring documentation</A> for how to configure the bean definition to use a different scope (e.g. request or session).</TD></TR></TABLE></DIV>

<H3><A name="SpringandStruts2-AlternativeHaveSpringManageCreationOfActionSupportClass"></A>Alternative - Have Spring Manage Creation Of ActionSupport Class</H3>

<P>Using the above methodology, the Struts 2 framework will still manage the creation of the ActionSupport class.  If you prefer you can configure the application so that Spring will create the ActionSupport class also.  To support this technique you need to add a bean node to the Spring configuration file for the ActionSupport class.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>Spring Configuration For ActionSupport Class Managed By Spring</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-xml">

<SPAN class="code-tag">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;</SPAN>
&lt;beans xmlns=<SPAN class="code-quote">&quot;http://www.springframework.org/schema/beans&quot;</SPAN>
       <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
       xsi:schemaLocation=&quot;
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
            

<SPAN class="code-tag">&lt;bean id=<SPAN class="code-quote">&quot;editService&quot;</SPAN> class=<SPAN class="code-quote">&quot;org.apache.struts.edit.service.EditServiceInMemory&quot;</SPAN> /&gt;</SPAN>

<SPAN class="code-tag">&lt;bean id=<SPAN class="code-quote">&quot;editAction&quot;</SPAN> class=<SPAN class="code-quote">&quot;org.apache.struts.edit.action.EditAction&quot;</SPAN> &gt;</SPAN>

	<SPAN class="code-tag">&lt;property name=<SPAN class="code-quote">&quot;editService&quot;</SPAN> ref=<SPAN class="code-quote">&quot;editService&quot;</SPAN> /&gt;</SPAN>
	
<SPAN class="code-tag">&lt;/bean&gt;</SPAN>

<SPAN class="code-tag">&lt;/beans&gt;</SPAN>

</PRE>
</DIV></DIV>

<P>Note in the above that there is an editAction bean and its editService property is set to the editService bean.  Since we are having Spring manage the EditAction class we must specify any properties of EditAction that we want Spring to inject.</P>

<P>In the struts.xml configuration file you must specify the Spring id value for the class attribute of the action node.  This tells Struts to get a bean with that id value from Spring for the Action class.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>Struts Configuration For Spring Managed ActionSupport Class</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-xml">

<SPAN class="code-tag">&lt;action name=<SPAN class="code-quote">&quot;edit&quot;</SPAN> class=<SPAN class="code-quote">&quot;editAction&quot;</SPAN> method=<SPAN class="code-quote">&quot;input&quot;</SPAN>&gt;</SPAN>
	<SPAN class="code-tag">&lt;result name=<SPAN class="code-quote">&quot;input&quot;</SPAN>&gt;</SPAN>/edit.jsp<SPAN class="code-tag">&lt;/result&gt;</SPAN>
<SPAN class="code-tag">&lt;/action&gt;</SPAN>

</PRE>
</DIV></DIV>

<H3><A name="SpringandStruts2-Summary"></A>Summary</H3>

<P>In this tutorial we reviewed how to use the Struts 2 Spring plugin to integrate Spring and Struts.  By using the Struts 2 Spring plugin you can have Spring manage the dependencies of your ActionSupport classes.  Of course you can also take advantage of the many other benefits (AOP, Spring JDBC) that the Spring framework provides.</P>


<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Next </TH>
<TD class="confluenceTd"> Onward to <A href="struts-2-annotations.html" title="Struts 2 Annotations">Struts 2 Annotations</A> </TD>
</TR>
<TR>
<TH class="confluenceTh">Previous </TH>
<TD class="confluenceTd"> Return to <A href="struts-2-themes.html" title="Struts 2 Themes">Struts 2 Themes</A> </TD>
</TR>
</TBODY></TABLE>
</DIV>






        </DIV>

        
      </DIV>
    </DIV>
    <DIV class="footer">
      Generated by
      <A href="http://www.atlassian.com/confluence/">Atlassian Confluence</A> (Version: 3.4.9 Build: 2042 Feb 14, 2011)
      <A href="http://could.it/autoexport/">Auto Export Plugin</A> (Version: 1.0.0-dkulp)
    </DIV>
  </BODY>
</HTML>